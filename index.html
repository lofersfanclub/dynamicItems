<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>

  <style src="style.css"></style>

</head>

<body>

<div id="carusel">

</div>

<script>

// Create an object:
var items = {
  5235: {
    title: "HEATMAX LASEROVN HM-DX32 3100W",
    description: "Description",
    cta: "Læg i kurv",
    ctaHref: "https://www.harald-nyborg.dk/p5235/termostatstyret-varmeovn-3100w",
    bestNr: "5235",
    price: "1.789,-",
    imageSrc: "https://www.harald-nyborg.dk/media/images/800/5235_989548.jpg"
  },
  10395: {
    title: "HANDSKER MED VARME STR L",
    description: "Description",
    cta: "Læg i kurv",
    ctaHref: "https://www.harald-nyborg.dk/p10395/handsker-med-varme-str-l",
    bestNr: "10395",
    price: "148",
    imageSrc: "https://www.harald-nyborg.dk/media/images/420/10395_691896.jpg"
  },
  6973: {
    title: "FAMILIEMIX 900G",
    description: "Description",
    cta: "Læg i kurv",
    ctaHref: "https://www.harald-nyborg.dk/p6973/familiemix-900g",
    bestNr: "6973",
    price: "48",
    imageSrc: "https://www.harald-nyborg.dk/media/images/800/6973_544224.jpg"
  },
  1528: {
    title: "STÅLREOL 172X75X30 4 HYLDER",
    description: "Description",
    cta: "Læg i kurv",
    ctaHref: "https://www.harald-nyborg.dk/p1528/stalreol-172x75x30-4-hylder",
    bestNr: "1528",
    price: "79",
    imageSrc: "https://www.harald-nyborg.dk/media/images/800/1528_330204.jpg"
  },
  5222: {
    title: "VILDFUGLEBLANDING 15 KG",
    description: "Description",
    cta: "Læg i",
    ctaHref: "https://www.harald-nyborg.dk/p5222/vildfugleblanding-15-kg",
    bestNr: "5222",
    price: "59,50",
    imageSrc: "https://www.harald-nyborg.dk/media/images/800/5222_341715.jpg"
  }
};

var id;

var itemsArray = [];
var favoritItems = [5222, 6973, 5235]

var element = document.getElementById("carusel");



function setCookie(cname,cvalue,exdays) {
    var d = new Date();
    d.setTime(d.getTime() + (exdays*24*60*60*1000));
    var expires = "expires=" + d.toGMTString();
    document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
}

function getCookie(cname) {
    var name = cname + "=";
    var decodedCookie = decodeURIComponent(document.cookie);
    var ca = decodedCookie.split(';');
    for(var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') {
            c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
            return c.substring(name.length, c.length);
        }
    }
    return "";
}

function checkCookie() {
    var user=getCookie("retargetItems");
    if (user != "") {
        itemsArray = user.split(",");
        console.log(typeof itemsArray);
        matchItems();
    } else {
           setCookie("retargetItems", favoritItems, 30);
    }
}

checkCookie();

function matchItems() {
  for (var item in itemsArray) {
    for (var key in items) {
      if (itemsArray[item] == key) {
        // skip loop if the property is from prototype
        if (!items.hasOwnProperty(key)) continue;
        id = key;
        var obj = items[key];
        var item = document.createElement("div");
        item.setAttribute("id", id);
        element.appendChild(item);
        var createdItem = document.getElementById(id);
        var title = document.createElement("p");
        var headline = document.createElement("h1");
        var cta = document.createElement("a");
        var nr = document.createElement("p");
        var titleText = document.createTextNode(obj.title);
        var textNode = document.createTextNode(obj.description);
        var ctaTextNode = document.createTextNode(obj.cta);
        var bestNr = "Best nr " + id;
        var nrTextNode = document.createTextNode(bestNr);
        for (var prop in obj) {
          // skip loop if the property is from prototype
          if (!obj.hasOwnProperty(prop)) continue;
        }
        createdItem.appendChild(title);
        createdItem.appendChild(headline);
        createdItem.appendChild(cta);
        createdItem.appendChild(nr);

        title.appendChild(titleText);
        headline.appendChild(textNode);
        cta.appendChild(ctaTextNode);
        nr.appendChild(nrTextNode);

        title.setAttribute("class", "name");
        headline.setAttribute("class", "description");
        cta.setAttribute("class", "cta");
        cta.setAttribute('href',obj.ctaHref);
        cta.setAttribute('target', '_blank');
        nr.setAttribute("class", "nr");
      }
    }
  }
}
</script>

</body>

</html>
